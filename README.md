# Сервис управления списком стран
REST-сервис для работы с актуальным списком стран мира

## Описание
Сервис предоставляет REST API для получения и управления списком стран на основе географических данных из открытого источника.

## Структура проекта
Слоистая архитектура: Контроллер → Сервис → Репозиторий → БД

1. Конфигурация (AppConfig): Настраивает Jackson ObjectMapper для работы с датами
2. Контроллер (CountryController): Принимает HTTP запросы и делегирует работу сервису
3. Сущность (CountryEntity): Представляет таблицу в БД, содержит бизнес-данные
4. Репозиторий (CountryRepository): Обеспечивает доступ к данным в БД через JPA
5. Country (Record) - DTO для передачи данных между слоями
6. DbCountryService (@Component) - бизнес-логика приложения
7. CountryService (Interface) - контракт для сервиса работы co списком стран
8. CountryListApplication (@SpringBootApplication) - главный класс приложения 
9. application.yml - конфигурация Spring Boot, БД, JPA, Flyway 
10. build.gradle - система сборки и управления зависимостями

## Источники данных
Исходные геоданные стран: react-svg-worldmap/countries.geo.ts

## База Данных
Схема БД: Flyway миграция V1__schema_init.sql
Тестовые данные: V2__insert_initial_data.sql
Полный список: V3__insert_all_countries.sql

## API Endpoints
Postman collection Country.postman_collection.json[resources/Country.postman_collection.json]

### GET /countries
Возвращает полный список всех стран из базы данных.

### GET /countries/{code}
Возвращает название страны по её коду.

### POST /countries
Добавляет новую страну.

json
{
"name": "Russia",
"isoCode": "RU",
"geometry": {
"type": "MultiPolygon",
"coordinates": [[[[[180, 66], [180, 60], [179, 59], [178, 58], [177, 57]]]]]
}
}

### PATCH /countries/{code}
Обновляет название страны по её коду.

json
{
  "name": "Новое название страны"
}

## Настройка БД
База данных инициализируется через Flyway миграции

При старте сервиса автоматически применяются все миграции

Данные стран загружаются из указанного источника

## Добавить данные в БД через SQL скрипт
INSERT INTO countries (name, iso_code, geometry, last_modify_date)
VALUES
(
'Fiji',
'FJ',
'{
"type": "MultiPolygon",
"coordinates": [
[
[
[[180, -16.067], [180, -16.555], [179.364, -16.801], [178.725, -17.012], [178.597, -16.639], [179.097, -16.434], [179.414, -16.379], [180, -16.067]]
],
[
[[178.126, -17.505], [178.374, -17.34], [178.718, -17.628], [178.553, -18.151], [177.933, -18.288], [177.381, -18.164], [177.285, -17.725], [177.671, -17.381], [178.126, -17.505]]
],
[
[[-179.793, -16.021], [-179.917, -16.502], [-180, -16.555], [-180, -16.067], [-179.793, -16.021]]
]
]
]
}',
CURRENT_DATE  -- Добавляем текущую дату
),
(
'Tanzania',
'TZ',
'{
"type": "MultiPolygon",
"coordinates": [
[
[
[[33.904, -0.95], [34.073, -1.06], [37.699, -3.097], [37.767, -3.677], [39.202, -4.677], [38.741, -5.909], [38.8, -6.476], [39.44, -6.84], [39.47, -7.1], [39.195, -7.704], [39.252, -8.008], [39.187, -8.486], [39.536, -9.112], [39.95, -10.098], [40.317, -10.317], [40.317, -10.317], [39.521, -10.897], [38.428, -11.285], [37.828, -11.269], [37.471, -11.569], [36.775, -11.595], [36.514, -11.721], [35.312, -11.439], [34.56, -11.52], [34.28, -10.16], [33.941, -9.694], [33.74, -9.417], [32.759, -9.231], [32.192, -8.93], [31.556, -8.762], [31.158, -8.595], [30.74, -8.34], [30.74, -8.34], [30.2, -7.08], [29.62, -6.52], [29.42, -5.94], [29.52, -5.42], [29.34, -4.5], [29.754, -4.452], [30.116, -4.09], [30.506, -3.569], [30.752, -3.359], [30.743, -3.034], [30.528, -2.808], [30.47, -2.414], [30.47, -2.414], [30.758, -2.287], [30.816, -1.699], [30.419, -1.135], [30.77, -1.015], [31.866, -1.027], [33.904, -0.95]]
]
]
]
}',
CURRENT_DATE  -- Добавляем текущую дату
)
ON CONFLICT (iso_code) DO NOTHING;


## Запуск
bash
./gradlew bootRun
или

bash
mvn spring-boot:run

## Конфигурация
Настройки подключения к БД и другие параметры настраиваются в application.properties